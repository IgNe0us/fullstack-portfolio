# k8s/frontend-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend-deployment # 디플로이먼트의 이름
spec:
  replicas: 1 # 우선 1개의 컨테이너(Pod)를 실행
  selector:
    matchLabels:
      app: frontend # 이 Deployment가 'app: frontend' 라벨이 붙은 Pod를 관리
  template: # --- 여기서부터가 컨테이너(Pod)의 실제 명세 ---
    metadata:
      labels:
        app: frontend # 이 Pod에 'app: frontend' 라벨을 붙임
    spec:
      containers:
        - name: frontend
          # [매우 중요!]
          # K8s는 로컬 build를 하지 않습니다.
          # CI/CD 파이프라인이 빌드해서 '이미지 저장소(GHCR)'에 올린 이미지를 사용합니다.
          # 'YOUR_GITHUB_ID/YOUR_REPO_NAME' 부분은 님의 GitHub 정보로 바꿔야 합니다.
          image: ghcr.io/YOUR_GITHUB_ID/YOUR_REPO_NAME/frontend:latest
          ports:
            - containerPort: 3000 # Next.js가 3000번 포트를 사용
          env:
            - name: SPRING_BOOT_URL
              # [연결 1] 'backend' 서비스 대신 K8s의 'backend-service'를 바라봄
              # (이 이름은 우리가 곧 만들 Service의 이름)
              value: "http://backend-service:8080"